{% extends "base.html" %}
{% block title %}ResNat · Home{% endblock %}
{% block content %}

<!-- HERO SEARCH (sus de tot) -->
<section class="search-hero container">
  <form class="searchbar" action="#" method="get" role="search" aria-label="Căutare globală (nefuncțională momentan)">
    <span class="search-icon" aria-hidden="true">
      <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="11" cy="11" r="7"></circle>
        <line x1="16.65" y1="16.65" x2="22" y2="22"></line>
      </svg>
    </span>
    <input
      type="search"
      name="q"
      id="global-search"
      placeholder="Caută o plantă, sit, habitat sau rezervație…"
      autocomplete="off"
      disabled
      aria-disabled="true"
    />
    <button type="button" class="search-btn" disabled>Caută</button>
  </form>

  <h1 class="welcome">
    Bun venit, {{ request.user.username }}<span class="muted">,</span> în <span class="brand-word">ResNat</span>!
  </h1>
</section>

<section class="container">

  <!-- KPIs -->
  <div class="grid grid-5">
    <div class="card kpi">
      <div class="kpi-value">{{ stats.species }}</div>
      <div class="kpi-label">Specii</div>
    </div>
    <div class="card kpi">
      <div class="kpi-value">{{ stats.reserves }}</div>
      <div class="kpi-label">Rezervații</div>
    </div>
    <div class="card kpi">
      <div class="kpi-value">{{ stats.sites }}</div>
      <div class="kpi-label">Site-uri</div>
    </div>
    <div class="card kpi">
      <div class="kpi-value">{{ stats.habitats }}</div>
      <div class="kpi-label">Habitate</div>
    </div>
    <div class="card kpi">
      <div class="kpi-value">{{ stats.occurrences }}</div>
      <div class="kpi-label">Observații</div>
      {% if stats.last_occurrence_at %}
        <div class="kpi-sub">ult. update: {{ stats.last_occurrence_at|date:"Y-m-d" }}</div>
      {% endif %}
    </div>
  </div>

  

  <!-- Admin (doar pentru cei cu dreptul de a adăuga sau staff) -->
  {% if request.user.is_authenticated %}
    {% if perms.core.add_occurrence or request.user.is_staff %}
      <div class="mt-3">
        <a href="/admin/" class="btn btn-outline">Adăugări / Administrare</a>
      </div>
    {% endif %}
  {% endif %}

</section>

<script>
  // Scurtături tastatură
  document.addEventListener('keydown', (e) => {
    if (['INPUT','TEXTAREA'].includes(document.activeElement.tagName)) return;
    if (e.key === 'f') window.location.href = "{% url 'associations_filters' %}";
    if (e.key === 'v') window.location.href = "{% url 'vizualizari_home' %}";
    if (e.key === 'c') window.location.href = "{% url 'comparatii_home' %}";
    {% if request.user.is_authenticated %}
      {% if perms.core.add_occurrence or request.user.is_staff %}
        if (e.key === 'a') window.location.href = "/admin/";
      {% endif %}
    {% endif %}
  });
</script>

{% endblock %}
